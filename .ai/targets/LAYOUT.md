<!-- @standalone -->
# Layout Guidelines (Canonical)

## AI WORKFLOW (REQUIRED)
1) Summarize 3-6 rules from this file before making changes.
2) STOP if you add new layout domains or modify existing domain slices.

## SCOPE
- Layout slices are now part of `@hai3/framework` (registered via layout plugin)
- Layout components live in `src/layout/` (user-owned, generated by CLI)
- Seven fixed layout domains: header, footer, menu, sidebar, screen, popup, overlay

## CRITICAL RULES
- Domain slices are read-only (modifications require proposal).
- Use selectors for state access (never access state directly).
- Actions dispatch through domain actions (e.g., `headerActions.setVisible()`).
- Screenset definitions follow `ScreensetDefinition` type.

## LAYOUT DOMAINS

| Domain | Purpose | Key Selectors |
|--------|---------|---------------|
| header | Top navigation | `selectHeaderVisible`, `selectHeaderUser` |
| footer | Bottom bar | `selectFooterVisible`, `selectFooterConfig` |
| menu | Side navigation | `selectMenuCollapsed`, `selectMenuItems` |
| sidebar | Collapsible panel | `selectSidebarVisible`, `selectSidebarWidth` |
| screen | Main content | `selectActiveScreen`, `selectScreenLoading` |
| popup | Modal dialogs | `selectActivePopup`, `selectHasPopup` |
| overlay | Full-screen overlays | `selectActiveOverlay`, `selectHasOverlay` |

## SCREENSET DEFINITION
```typescript
// REQUIRED: Follow ScreensetDefinition type
const myScreenset: ScreensetDefinition = {
  id: SCREENSET_ID,
  name: 'My Screenset',
  category: ScreensetCategory.Drafts,
  defaultScreen: 'home',
  localization: translationLoader,
  menu: [
    { menuItem: { id: 'home', icon: 'lucide:home', ... }, screen: () => import('./Home') }
  ]
};
```

## MENU ICON RULES
- REQUIRED: MenuItem.icon is Iconify string ID (e.g., "lucide:home", "lucide:palette").
- REQUIRED: Menu.tsx uses Icon component from @iconify/react to render icons.
- REQUIRED: App logo icons (HAI3LogoIcon) imported directly from @/app/icons/.
- FORBIDDEN: React.ComponentType in MenuItem.icon (causes serialization warnings).

## SELECTOR USAGE
```typescript
// GOOD: Use typed selectors
const isCollapsed = useAppSelector(selectMenuCollapsed);

// BAD: Direct state access
const isCollapsed = state.layout.menu.collapsed; // FORBIDDEN
```

## STOP CONDITIONS
- Adding new layout domains (requires architecture decision).
- Modifying domain slice reducers.
- Bypassing selectors for direct state access.
- Creating custom layout slices outside the 7 domains.

## PRE-DIFF CHECKLIST
- [ ] Using domain selectors (not direct state access).
- [ ] Using domain actions (not direct dispatch).
- [ ] Screenset follows ScreensetDefinition type.
- [ ] No modifications to layout domain slices.
